# 预埋 Bug 清单（仅出题者可见）
注意：该文档包含“预埋缺陷”信息，请勿提供给测试实习生。

## 条目模板（建议统一格式）
- ID: FE01 / BE01
- 标题:
- 模块: 商品/库存/入库/出库/仓库设置/权限
- 难度: 低/中/高
- 对应 PRD: 章节路径（例如：PRD-库存管理-盘点单只能提交一次）
- 复现前置数据:
- 复现步骤:
  1)
  2)
  3)
- 预期结果:（按 PRD）
- 实际结果:（系统表现）
- 建议断言点:（接口响应码/页面提示/数据库变更/Network 请求等）
- 定位线索（仅出题者）:

## 前端 Bug（FE01–FE20）
### 低级（6）
#### FE01 入库单列表仓库切换不刷新
- 模块: 入库管理
- 难度: 低
- 对应 PRD: 入库管理-入库单列表-按仓库筛选后应立即刷新
- 复现: 切换仓库筛选条件
- 预期: 列表刷新
- 实际: 列表不刷新

#### FE02 库存盘点提交按钮无效
- 模块: 库存管理
- 难度: 低
- 对应 PRD: 库存管理-盘点单-提交

#### FE03 库存预警列表不显示零库存
- 模块: 库存管理
- 难度: 低
- 对应 PRD: 库存管理-预警-包含库存=0

#### FE04 商品列表分页显示 NaN
- 模块: 商品管理
- 难度: 低
- 对应 PRD: 商品管理-列表分页

#### FE05 入库日期显示 Invalid Date
- 模块: 入库管理
- 难度: 低
- 对应 PRD: 通用规则-时间格式

#### FE06 中文输入搜索闪烁
- 模块: 商品管理
- 难度: 低
- 对应 PRD: 通用规则-中文输入 composing 期间不触发搜索

### 中级（8）
#### FE07 拣货确认提交旧 SKU（闭包旧值）
- 模块: 出库管理
- 难度: 中
- 对应 PRD: 出库管理-拣货确认

#### FE08 批量出库状态显示错乱（状态覆盖）
- 模块: 出库管理
- 难度: 中
- 对应 PRD: 出库管理-创建/处理

#### FE09 快速切换页面报错（卸载后 setState）
- 模块: 通用
- 难度: 中
- 对应 PRD: 交互规范

#### FE10 入库数量计算错误（字符串拼接）
- 模块: 入库管理
- 难度: 中
- 对应 PRD: 入库管理-数量为正整数

#### FE11 删除出库单后列表未刷新
- 模块: 出库管理
- 难度: 中
- 对应 PRD: 交互规范-删除成功后列表应移除

#### FE12 表单重复提交导致重复单据
- 模块: 入库管理
- 难度: 中
- 对应 PRD: 交互规范-防重复提交

#### FE13 商品编辑后列表显示旧数据
- 模块: 商品管理
- 难度: 中
- 对应 PRD: 商品管理-编辑后列表应立即刷新

#### FE14 金额精度问题（小数运算）
- 模块: 入库管理
- 难度: 中
- 对应 PRD: 入库管理-金额保留2位小数

### 高级（6）
#### FE15 库存查询页面无限刷新
- 模块: 库存管理
- 难度: 高
- 对应 PRD: 交互规范-筛选后刷新（但不能无限请求）

#### FE16 商品名称 XSS
- 模块: 商品管理
- 难度: 高
- 对应 PRD: 安全要求

#### FE17 入库单号越权访问（IDOR）
- 模块: 入库管理/权限
- 难度: 高
- 对应 PRD: 仓库数据隔离

#### FE18 出库超库存前端未提示
- 模块: 出库管理
- 难度: 高
- 对应 PRD: 出库管理-库存校验

#### FE19 预警阈值修改不生效
- 模块: 库存管理
- 难度: 高
- 对应 PRD: 库存预警-阈值修改后立即生效

#### FE20 删除商品行后总数未重算
- 模块: 入库管理
- 难度: 高
- 对应 PRD: 入库管理-总数量/金额自动重算

## 后端 Bug（BE01–BE23）
### 低级（6）
#### BE01 创建入库单接口返回结构错误（缺 return/返回 None）
- 模块: 入库管理
- 难度: 低
- 对应 PRD: 通用约定-统一响应结构

#### BE02 库位详情接口参数名不匹配（导致 422）
- 模块: 仓库设置
- 难度: 低
- 对应 PRD: 仓库设置-库位详情

#### BE03 健康检查接口响应格式不一致
- 模块: 通用
- 难度: 低
- 对应 PRD: 通用约定-统一响应结构
- 复现: 访问 GET /api/health
- 预期结果: 应返回标准格式 {"code": "OK", "message": "ok", "data": {...}}
- 实际结果: 直接返回 {"status": "ok"}
- 定位线索: backend/app/routers/health.py

#### BE04 分页参数未校验（page=-1/page_size=0）
- 模块: 商品/入库/出库
- 难度: 低
- 对应 PRD: 通用约定-分页

#### BE05 删除商品接口缺 commit（返回成功但未删除）
- 模块: 商品管理
- 难度: 低
- 对应 PRD: 商品管理-删除

#### BE06 时间序列化不统一
- 模块: 通用
- 难度: 低
- 对应 PRD: 通用约定-时间格式

### 中级（9）
#### BE07 发货后库存未扣减（逻辑未生效）
- 模块: 出库管理
- 难度: 中
- 对应 PRD: 出库管理-发货确认扣减库存

#### BE08 发货失败未回滚库存
- 模块: 出库管理
- 难度: 中
- 对应 PRD: 出库管理-发货失败回滚

#### BE09 允许负数入库
- 模块: 入库管理
- 难度: 中
- 对应 PRD: 入库数量必须 >0

#### BE10 调拨非原子导致数据不一致
- 模块: 库存管理
- 难度: 中
- 对应 PRD: 库存调拨-原子性

#### BE11 SKU 可重复创建
- 模块: 商品管理
- 难度: 中
- 对应 PRD: SKU 唯一

#### BE12 出库数量超过库存仍能成功
- 模块: 出库管理
- 难度: 中
- 对应 PRD: 库存校验/不可超卖

#### BE13 order_by 未做白名单校验导致报错
- 模块: 商品管理
- 难度: 中
- 对应 PRD: 列表查询

#### BE14 单据状态机未限制（可重复确认/越状态）
- 模块: 入库/出库
- 难度: 中
- 对应 PRD: 状态流转不可逆

#### BE15 日志打印敏感信息
- 模块: 权限/安全
- 难度: 中
- 对应 PRD: 安全要求-密码不写日志

### 高级（8）
#### BE16 SQL 注入（库存查询）
- 模块: 库存管理
- 难度: 高
- 对应 PRD: SQL 参数化

#### BE17 N+1 查询（出库单列表）
- 模块: 出库管理
- 难度: 高
- 对应 PRD: 出库单列表

#### BE18 缺少审计日志
- 模块: 库存管理
- 难度: 高
- 对应 PRD: 库存变动审计日志

#### BE19 无鉴权接口可直接访问
- 模块: 权限
- 难度: 高
- 对应 PRD: 所有接口需登录

#### BE20 普通用户可访问管理员接口（角色越权）
- 模块: 权限
- 难度: 高
- 对应 PRD: 管理员接口角色校验

#### BE21 仓库数据隔离缺失（IDOR）
- 模块: 权限
- 难度: 高
- 对应 PRD: 仓库数据隔离

#### BE22 盘点可重复提交
- 模块: 库存管理
- 难度: 高
- 对应 PRD: 盘点单只能提交一次

#### BE23 入库确认后仍可修改数量
- 模块: 入库管理
- 难度: 高
- 对应 PRD: 已入库不可修改
